-- SERVICES
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Debris = game:GetService("Debris")

local player = Players.LocalPlayer

-- GLOBALS
_G.Active = false
_G.Running = true
_G.AutoReset = true

local speed = 20
local minSpeed = 10
local maxSpeed = 30
local maxCoins = 50 
local coinCount = 0
local ignored = {}
local isFirstCoin = true

-- GUI CLEANUP
if player.PlayerGui:FindFirstChild("FastFarm") then
	player.PlayerGui.FastFarm:Destroy()
end

-- SCREEN GUI
local sg = Instance.new("ScreenGui")
sg.Name = "FastFarm"
sg.Parent = player.PlayerGui
sg.ResetOnSpawn = false

-- ðŸ”Š CLICK SOUND FUNCTION
local function playClickSound()
	local s = Instance.new("Sound")
	s.SoundId = "rbxassetid://5852470908"
	s.Volume = 1
	s.Parent = sg
	s:Play()
	Debris:AddItem(s, s.TimeLength)
end

-- MAIN FRAME
local main = Instance.new("Frame")
main.Parent = sg
main.Size = UDim2.new(0, 270, 0, 320)
main.Position = UDim2.new(0.5, -135, 0.5, -160)
main.BackgroundColor3 = Color3.fromRGB(0,0,0)
main.Active = true
main.ClipsDescendants = true
main.BackgroundTransparency = 0.3

-- STROKE
local stroke = Instance.new("UIStroke", main)
stroke.Thickness = 3
stroke.Color = Color3.fromRGB(120, 120, 255)

-- HEADER
local header = Instance.new("TextLabel", main)
header.Size = UDim2.new(1, 0, 0, 50)
header.Text = "      EXOTIC HUB"
header.Font = Enum.Font.GothamBold
header.TextSize = 22
header.TextColor3 = Color3.fromRGB(230, 230, 255)
header.BackgroundTransparency = 1
header.TextXAlignment = Enum.TextXAlignment.Left
header.Active = true

-- DRAG LOGIC
do
	local dragging, dragStart, startPos
	header.InputBegan:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = i.Position
			startPos = main.Position
		end
	end)
	UserInputService.InputChanged:Connect(function(i)
		if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
			local delta = i.Position - dragStart
			main.Position = UDim2.new(
				startPos.X.Scale, startPos.X.Offset + delta.X,
				startPos.Y.Scale, startPos.Y.Offset + delta.Y
			)
		end
	end)
	UserInputService.InputEnded:Connect(function(i)
		if i.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = false
		end
	end)
end

-- CLOSE BUTTON
local close = Instance.new("TextButton", main)
close.Size = UDim2.new(0, 30, 0, 30)
close.Position = UDim2.new(1, -40, 0, 10)
close.Text = "X"
close.Font = Enum.Font.FredokaOne
close.TextSize = 16
close.TextColor3 = Color3.new(1,1,1)
close.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
Instance.new("UICorner", close).CornerRadius = UDim.new(0, 8)

close.MouseButton1Click:Connect(function()
	playClickSound()
	_G.Active = false
	_G.Running = false
	sg:Destroy()
end)

-- TOGGLE FUNCTION
local function createToggle(text, y, default, callback)
	local holder = Instance.new("Frame", main)
	holder.Size = UDim2.new(1, -40, 0, 42)
	holder.Position = UDim2.new(0, 20, 0, y)
	holder.BackgroundTransparency = 1

	local label = Instance.new("TextLabel", holder)
	label.Size = UDim2.new(1, -70, 1, 0)
	label.Text = text
	label.Font = Enum.Font.GothamBold
	label.TextSize = 16
	label.TextColor3 = Color3.fromRGB(235,235,235)
	label.BackgroundTransparency = 1
	label.TextXAlignment = Enum.TextXAlignment.Left

	local toggle = Instance.new("Frame", holder)
	toggle.Size = UDim2.new(0, 42, 0, 22)
	toggle.Position = UDim2.new(1, -42, 0.5, -11)
	toggle.BackgroundColor3 = default and Color3.fromRGB(60,200,120) or Color3.fromRGB(200,70,70)
	Instance.new("UICorner", toggle).CornerRadius = UDim.new(1, 0)

	local knob = Instance.new("Frame", toggle)
	knob.Size = UDim2.new(0, 18, 0, 18)
	knob.Position = default and UDim2.new(1, -20, 0.5, -9) or UDim2.new(0, 2, 0.5, -9)
	knob.BackgroundColor3 = Color3.fromRGB(245,245,245)
	Instance.new("UICorner", knob).CornerRadius = UDim.new(1, 0)

	local hit = Instance.new("TextButton", toggle)
	hit.Size = UDim2.new(1,0,1,0)
	hit.Text = ""
	hit.BackgroundTransparency = 1

	local state = default
	hit.MouseButton1Click:Connect(function()
		playClickSound()
		state = not state
		if text == "Auto Farm" then isFirstCoin = true end
		TweenService:Create(toggle, TweenInfo.new(0.2), {
			BackgroundColor3 = state and Color3.fromRGB(60,200,120) or Color3.fromRGB(200,70,70)
		}):Play()
		TweenService:Create(knob, TweenInfo.new(0.2), {
			Position = state and UDim2.new(1,-20,0.5,-9) or UDim2.new(0,2,0.5,-9)
		}):Play()
		callback(state)
	end)
end

createToggle("Auto Farm", 70, false, function(v) _G.Active = v end)
createToggle("Reset When Full Bag", 120, true, function(v) _G.AutoReset = v end)

-- SLIDER CLICK SOUND
local sliding = false
local function updateSlider()
	local mousePos = UserInputService:GetMouseLocation().X
	local barPos = bar.AbsolutePosition.X
	local barSize = bar.AbsoluteSize.X
	local x = math.clamp((mousePos - barPos) / barSize, 0, 1)
	speed = math.floor(minSpeed + (x * (maxSpeed - minSpeed)))
	fill.Size = UDim2.new(x, 0, 1, 0)
	knobS.Position = UDim2.new(x, -8, 0.5, -8)
	valueLabel.Text = tostring(speed)
end
