local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer

_G.Active = false
_G.Running = true

local speed = 22
local ignored = {}

-- GUI
if player.PlayerGui:FindFirstChild("FastFarm") then
    player.PlayerGui.FastFarm:Destroy()
end

local sg = Instance.new("ScreenGui")
sg.Name = "FastFarm"
sg.Parent = player:WaitForChild("PlayerGui")
sg.ResetOnSpawn = false

-- FARM BUTTON
local btn = Instance.new("TextButton", sg)
btn.Size = UDim2.new(0,160,0,45)
btn.Position = UDim2.new(0.5,-80,0.05,0)
btn.BackgroundColor3 = Color3.fromRGB(150,50,50)
btn.Text = "FARM: OFF"
btn.TextColor3 = Color3.new(1,1,1)
btn.Font = Enum.Font.SourceSansBold
btn.TextSize = 18
Instance.new("UICorner", btn)

-- CLOSE
local close = Instance.new("TextButton", sg)
close.Size = UDim2.new(0,25,0,25)
close.Position = UDim2.new(0.5,90,0.05,0)
close.BackgroundColor3 = Color3.fromRGB(200,0,0)
close.Text = "X"
close.TextColor3 = Color3.new(1,1,1)
Instance.new("UICorner", close).CornerRadius = UDim.new(1,0)

-- SPEED SLIDER (15â€“25)
local sliderBg = Instance.new("Frame", sg)
sliderBg.Size = UDim2.new(0,160,0,8)
sliderBg.Position = UDim2.new(0.5,-80,0.13,0)
sliderBg.BackgroundColor3 = Color3.fromRGB(80,80,80)
Instance.new("UICorner", sliderBg)

local slider = Instance.new("Frame", sliderBg)
slider.Size = UDim2.new((speed-15)/10,0,1,0)
slider.BackgroundColor3 = Color3.fromRGB(50,200,50)
Instance.new("UICorner", slider)

local dragging = false

sliderBg.InputBegan:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
    end
end)

sliderBg.InputEnded:Connect(function(i)
    if i.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

RunService.RenderStepped:Connect(function()
    if dragging then
        local mouseX = UserInputService:GetMouseLocation().X
        local x = math.clamp(
            (mouseX - sliderBg.AbsolutePosition.X) / sliderBg.AbsoluteSize.X,
            0, 1
        )
        slider.Size = UDim2.new(x,0,1,0)
        speed = math.floor(15 + (25 - 15) * x)
    end
end)

-- WARNING
local warn = Instance.new("TextLabel", sg)
warn.Size = UDim2.new(0,240,0,30)
warn.Position = UDim2.new(0.5,-120,0.16,0)
warn.BackgroundTransparency = 1
warn.Text = "Warning: Speed above 22 may kick you"
warn.TextColor3 = Color3.fromRGB(255,120,120)
warn.Font = Enum.Font.SourceSans
warn.TextSize = 14

-- SIGNATURE
local sign = Instance.new("TextLabel", sg)
sign.Size = UDim2.new(0,160,0,20)
sign.Position = UDim2.new(0.5,-80,0.20,0)
sign.BackgroundTransparency = 1
sign.Text = "BY: xemio612"
sign.TextColor3 = Color3.fromRGB(200,200,200)
sign.Font = Enum.Font.SourceSansItalic
sign.TextSize = 14

-- NOCLIP
RunService.Stepped:Connect(function()
    if _G.Active and player.Character then
        for _,v in pairs(player.Character:GetDescendants()) do
            if v:IsA("BasePart") then
                v.CanCollide = false
            end
        end
    end
end)

-- TELEPORT FARM (DYNAMIC SPEED)
task.spawn(function()
    while _G.Running do
        if _G.Active then
            local char = player.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")

            if root then
                local target, dist = nil, math.huge

                for _,v in pairs(workspace:GetDescendants()) do
                    if (v.Name == "Coin" or v.Name == "Coin_Server")
                        and v:IsA("BasePart")
                        and not ignored[v] then

                        local d = (root.Position - v.Position).Magnitude
                        if d < dist then
                            dist = d
                            target = v
                        end
                    end
                end

                if target then
                    -- teleport directly to coin
                    root.CFrame = target.CFrame * CFrame.new(0,3,0)
                    ignored[target] = true

                    -- closer = faster
                    local delayTime = math.clamp(dist / speed, 0.05, 1)
                    task.wait(delayTime)
                else
                    ignored = {}
                    task.wait(0.2)
                end
            end
        end
        task.wait()
    end
end)

-- BUTTONS
btn.MouseButton1Click:Connect(function()
    _G.Active = not _G.Active
    btn.Text = _G.Active and "FARM: ON" or "FARM: OFF"
    btn.BackgroundColor3 = _G.Active
        and Color3.fromRGB(50,150,50)
        or Color3.fromRGB(150,50,50)

    if _G.Active then
        ignored = {}
    end
end)

close.MouseButton1Click:Connect(function()
    _G.Active = false
    _G.Running = false
    sg:Destroy()
end)
